<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138613977-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-138613977-1');
</script>


  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>LFortran now compiles SNAP - </title>

  <meta name="description" content="We are thrilled to announce that LFortran can now successfully compile and run lanl/SNAP, marking a significant milestone in our journey to beta. SNAP is the seventh production-grade, third-party code that LFortran can compile, bringing us closer to our goal of compiling 10 such codes—a critical step toward a beta-quality compiler.
 About SNAP SNAP (SN Discrete Ordinates Application Proxy) is a proxy application designed to emulate the performance of modern discrete ordinates neutral particle transport codes."><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "LFortran",
    
    "url": "https:\/\/lfortran.org\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/lfortran.org\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/lfortran.org\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/lfortran.org\/blog\/2024\/08\/lfortran-now-compiles-snap\/",
          "name": "Lfortran now compiles SNA p"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "[Gaurav Dhingra](https:\/\/github.com\/gxyd), [Assem Medhat](https:\/\/github.com\/assem2002), [Saurabh Kumar](https:\/\/github.com\/kmr-srbh), [Pranav Goswami](https:\/\/www.linkedin.com\/in\/pranavgoswami1\/), [Ondřej Čertík](https:\/\/ondrejcertik.com\/), [Gagandeep Singh](https:\/\/github.com\/czgdp1807), [Ubaid Shaikh](https:\/\/github.com\/Shaikh-Ubaid), [Thirumalai Shaktivel](https:\/\/www.linkedin.com\/in\/thirumalai-shaktivel\/), [Harshita Kalani](https:\/\/www.linkedin.com\/in\/harshita-kalani-604866225\/), [Parth Mistry](https:\/\/github.com\/parth121101), [Vipul Cariappa](https:\/\/github.com\/Vipul-Cariappa), [Shivi Mathur](https:\/\/github.com\/shivimathur), [Kerim Birgi](https:\/\/github.com\/KGB99), [Serge Sans Paille](https:\/\/github.com\/serge-sans-paille), [Advik Kabra](https:\/\/github.com\/advikkabra), [Christoph Junghans](https:\/\/github.com\/junghans), [Tanay Manerikar](https:\/\/github.com\/tanay-man), [Wolf Vollprecht](https:\/\/github.com\/wolfv)"
  },
  "headline": "LFortran now compiles SNAP",
  "description" : "We are thrilled to announce that LFortran can now successfully compile and run lanl\/SNAP, marking a significant milestone in our journey to beta. SNAP is the seventh production-grade, third-party code that LFortran can compile, bringing us closer to our goal of compiling 10 such codes—a critical step toward a beta-quality compiler.\n About SNAP SNAP (SN Discrete Ordinates Application Proxy) is a proxy application designed to emulate the performance of modern discrete ordinates neutral particle transport codes.",
  "inLanguage" : "en",
  "wordCount":  1437 ,
  "datePublished" : "2024-08-27T00:00:00",
  "dateModified" : "2024-08-27T00:00:00",
  "image" : "https:\/\/lfortran.org\/",
  "keywords" : [ "Fortran, Announcement, Fortran-lang, SNAP, LANL" ],
  "mainEntityOfPage" : "https:\/\/lfortran.org\/blog\/2024\/08\/lfortran-now-compiles-snap\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/lfortran.org\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/lfortran.org\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="LFortran now compiles SNAP" />
<meta property="og:description" content="We are thrilled to announce that LFortran can now successfully compile and run lanl/SNAP, marking a significant milestone in our journey to beta. SNAP is the seventh production-grade, third-party code that LFortran can compile, bringing us closer to our goal of compiling 10 such codes—a critical step toward a beta-quality compiler.
 About SNAP SNAP (SN Discrete Ordinates Application Proxy) is a proxy application designed to emulate the performance of modern discrete ordinates neutral particle transport codes.">
<meta property="og:url" content="https://lfortran.org/blog/2024/08/lfortran-now-compiles-snap/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="LFortran" />

  <meta name="twitter:title" content="LFortran now compiles SNAP" />
  <meta name="twitter:description" content="We are thrilled to announce that LFortran can now successfully compile and run lanl/SNAP, marking a significant milestone in our journey to beta. SNAP is the seventh production-grade, third-party code …">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="generator" content="Hugo 0.96.0" />
  <link rel="alternate" href="https://lfortran.org/index.xml" type="application/rss+xml" title="LFortran"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://lfortran.org/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://lfortran.org/css/syntax.css" /><link rel="stylesheet" href="https://lfortran.org/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">





<style>
h2 {
    font-size: 20px;
}
p, li {
    text-align: justify;
}
img {
    display: inline;
}
h1.h1heading {
    text-align: center;
}
h2.h2heading {
    text-align: center;
    font-size: 20px;
    font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    font-weight: 300;
    margin: 0 0 0;
}
#benefit i {
    margin-right: 20px;
}
#benefit {
    padding-left: 30px;
    padding-right: 30px;
}
#benefits {
    margin-top: 30px;
    margin-bottom: 50px;
}
.post-heading .post-meta a {
  color: #008AFF;
}
.post-heading .post-meta a:hover, a:focus {
  color: #0085a1;
  text-decoration: underline;
}

[data-toggle="collapse"].collapsed .if-not-collapsed {
  display: none;
}
[data-toggle="collapse"]:not(.collapsed) .if-collapsed {
  display: none;
}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138613977-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://lfortran.org/">LFortran</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Download" href="/download/">Download</a>
            </li>
          
        
          
            <li>
              <a title="Documentation" href="https://docs.lfortran.org/">Documentation</a>
            </li>
          
        
          
            <li>
              <a title="Blog" href="/blog/">Blog</a>
            </li>
          
        

        

        
      </ul>
    </div>

    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>LFortran now compiles SNAP</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on August 27, 2024
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;7&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1437&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;<a href="https://github.com/gxyd">Gaurav Dhingra</a>, <a href="https://github.com/assem2002">Assem Medhat</a>, <a href="https://github.com/kmr-srbh">Saurabh Kumar</a>, <a href="https://www.linkedin.com/in/pranavgoswami1/">Pranav Goswami</a>, <a href="https://ondrejcertik.com/">Ondřej Čertík</a>, <a href="https://github.com/czgdp1807">Gagandeep Singh</a>, <a href="https://github.com/Shaikh-Ubaid">Ubaid Shaikh</a>, <a href="https://www.linkedin.com/in/thirumalai-shaktivel/">Thirumalai Shaktivel</a>, <a href="https://www.linkedin.com/in/harshita-kalani-604866225/">Harshita Kalani</a>, <a href="https://github.com/parth121101">Parth Mistry</a>, <a href="https://github.com/Vipul-Cariappa">Vipul Cariappa</a>, <a href="https://github.com/shivimathur">Shivi Mathur</a>, <a href="https://github.com/KGB99">Kerim Birgi</a>, <a href="https://github.com/serge-sans-paille">Serge Sans Paille</a>, <a href="https://github.com/advikkabra">Advik Kabra</a>, <a href="https://github.com/junghans">Christoph Junghans</a>, <a href="https://github.com/tanay-man">Tanay Manerikar</a>, <a href="https://github.com/wolfv">Wolf Vollprecht</a>
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>We are thrilled to announce that LFortran can now successfully compile and run <a href="https://github.com/lanl/SNAP">lanl/SNAP</a>, marking a significant milestone in our journey to beta. SNAP is the seventh production-grade, third-party code that LFortran can compile, bringing us closer to our goal of compiling 10 such codes—a critical step toward a beta-quality compiler.</p>
<hr>
<h2 id="about-snap">About SNAP</h2>
<p><strong>SNAP</strong> (<em>SN</em> Discrete Ordinates <em>Application Proxy</em>) is a proxy application designed to emulate the performance of modern discrete ordinates neutral particle transport codes. It replicates the computational workload, memory requirements, and communication patterns of the Los Alamos National Laboratory code PARTISN, without including actual physics. By using domain decomposition and parallelization across spatial, angular, and energy domains, SNAP is ideal for performance testing on cutting-edge high-performance computing systems.</p>
<p>It is also a great application to test LFortran on, as it exercises the typical
Fortran features used for computational physics, has a simple build system, and
it is about 10K lines. By being able to compile it and run it
successfully (reproducing results from other compilers), LFortran is well on
its way of becoming a solid compiler that you can depend on.</p>
<h3 id="how-to-compile-snap-with-lfortran">How to Compile SNAP with LFortran</h3>
<p>Follow the commands shown below to build and compile SNAP with LFortran.</p>
<h3 id="set-up-the-environment">Set up the Environment</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>conda create -n lfortran lfortran<span style="color:#f92672">=</span>0.40.0 make
</span></span><span style="display:flex;"><span>conda activate lfortran
</span></span><span style="display:flex;"><span>git clone https://github.com/certik/SNAP
</span></span><span style="display:flex;"><span>cd SNAP
</span></span><span style="display:flex;"><span>git checkout -t origin/lf11
</span></span><span style="display:flex;"><span>cd src
</span></span></code></pre></div><p><strong>Note:</strong> Currently, compilation is only supported with MPI and OpenMP turned off. Ensure that these features are disabled in the build flags to avoid any issues.</p>
<h3 id="build-in-debug-mode">Build in Debug mode</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>make FORTRAN=lfortran FFLAGS= MPI=no OPENMP=no
</span></span><span style="display:flex;"><span>./gsnap ../qasnap/sample/inp out
</span></span></code></pre></div><h3 id="build-in-release-mode">Build in Release mode</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>make clean
</span></span><span style="display:flex;"><span>make FORTRAN=lfortran FFLAGS=&#34;--fast --skip-pass=promote_allocatable_to_nonallocatable&#34; MPI=no OPENMP=no
</span></span><span style="display:flex;"><span>./gsnap ../qasnap/sample/inp out
</span></span></code></pre></div><h3 id="compilation-benchmarks">Compilation Benchmarks</h3>
<p>We conducted several benchmarks to compare LFortran with GFortran and Flang in compiling the SNAP codebase. Using <code>lfortran=0.40.0</code> on a Surface 5 laptop:</p>
<table>
<thead>
<tr>
<th>Test Scenario</th>
<th>Compiler</th>
<th>Command</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>Compiling snap_main.f90 as a module</td>
<td>LFortran 0.40.0</td>
<td><code>time make FORTRAN=lfortran FFLAGS= MPI=no OPENMP=no snap_main.o</code></td>
<td>0.399s</td>
</tr>
<tr>
<td></td>
<td>GFortran 13.2.0</td>
<td><code>time make FORTRAN=gfortran FFLAGS= MPI=no OPENMP=no snap_main.o</code></td>
<td>1.183s</td>
</tr>
<tr>
<td>Full Compilation</td>
<td>LFortran 0.40.0</td>
<td><code>time make FORTRAN=lfortran FFLAGS= MPI=no OPENMP=no</code></td>
<td>2.499s</td>
</tr>
<tr>
<td></td>
<td>GFortran 13.2.0</td>
<td><code>time make FORTRAN=gfortran FFLAGS= MPI=no OPENMP=no</code></td>
<td>1.310s</td>
</tr>
<tr>
<td></td>
<td>Flang 18.1.6</td>
<td><code>time make FORTRAN=flang-new FFLAGS= MPI=no OPENMP=no</code></td>
<td>10.168s</td>
</tr>
<tr>
<td>Single File Compilation</td>
<td>LFortran 0.40.0</td>
<td><code>time lfortran --no-warnings main.f90 -o xx</code></td>
<td>2.042s</td>
</tr>
<tr>
<td></td>
<td>GFortran 13.2.0</td>
<td><code>time gfortran main.f90 -o xx</code></td>
<td>0.794s</td>
</tr>
<tr>
<td></td>
<td>Flang 18.1.6</td>
<td><code>time flang-new main.f90 -o xx</code></td>
<td>1.713s</td>
</tr>
</tbody>
</table>
<p>While LFortran shows promising results, especially in the module-based
approach, there is still room for improvement in single-file compilation where
GFortran currently holds an advantage. Ongoing work to optimize LFortran’s
integration with LLVM is expected to enhance these benchmarks further. After we
reach beta, we also plan to invest into our alternative backends like WASM that
allow much faster compilation speed.</p>
<p>Also, we shall note that there are two small workarounds that are currently needed:</p>
<ul>
<li>Namelist: <a href="https://github.com/lfortran/lfortran/issues/1999">issue#1999</a></li>
<li>Wrap a global subroutine into a module: <a href="https://github.com/lfortran/lfortran/issues/4175">issue#4175</a></li>
</ul>
<p>We will implement namelists later, and the global subroutine issue we plan to fix after beta. The workaround however could be argued is an improvement to the original code, since a compiler cannot in general check argument types when calling global subroutines, while it checks everything if they are inside a module.</p>
<p>There is also a bug in the build system on macOS, which we fixed and submitted a PR upstream: <a href="https://github.com/lanl/SNAP/pull/21">SNAP#21</a>.</p>
<h2 id="development-overview">Development Overview</h2>
<p>Achieving this milestone was not without its challenges. We encountered some technical hurdles, but our team&rsquo;s collaborative effort and determination ensured that these were swiftly addressed. Below are some of the key areas where we focused our development:</p>
<h3 id="provide-nullify-support">Provide <code>nullify</code> support</h3>
<p>We implemented <code>nullify</code> mechanism in the LLVM backend. We used the LLVM API and the utilities we built before to make the array variable point to a null pointer. The issue was fixed via <a href="https://github.com/lfortran/lfortran/pull/4517">PR#4517</a>.</p>
<h3 id="improving-pointer-management-with-nullify">Improving pointer management with <code>nullify</code></h3>
<p>We also worked on addressing an issue related to the <code>nullify</code> statement, where LFortran had difficulties handling pointer-arrays allocation after nullifying it. This led to further enhancements in LFortran&rsquo;s allocation technique and also opened our eyes to a subtle bug that we may encounter later. The related issue is tracked at <a href="https://github.com/lfortran/lfortran/issues/4635">issue#4653</a>.</p>
<h3 id="assignment-to-array-of-structs">Assignment to array of structs</h3>
<p>We had to provide an implmentation to handle such an expression <code>a%num = 44</code> where <code>a</code> is an array. We had to detect the existence of an array and then to build a loop on its indices to set their member <code>num</code> with value <code>44</code>. Due to the flexibility in the ASR builder and the strong utilities: such a task was easy to implement. One may track it at <a href="https://github.com/lfortran/lfortran/issues/4579">issue#4579</a>.</p>
<h3 id="where-statement-for-looping-on-every-dimension">Where statement for looping on every dimension</h3>
<p>We missed the case of doing nested loops on all of the array dimensions so we can test the predicate of the <code>where</code> statment. Fixing that was easy with the help of utilites and the separate-function responsibilites, We just got a recursive call to build nested DO loops from ground up. Feel free to lookup <a href="https://github.com/lfortran/lfortran/issues/4510">issue#4510</a>.</p>
<h3 id="support-printing-and-writing-of-tuple-in-implieddoloop">Support printing and writing of <code>tuple</code> in <code>ImpliedDoLoop</code></h3>
<p>Fortran syntax doesn&rsquo;t support compound data type such as tuples, except in one
special case: implied do loops in print or write statements. There are multiple
ways to implement this feature in a compiler, and we chose to use tuples since
LCompilers internally already support tuples for LPython. We got the ASR
builder identifying <code>tuple</code> in the implied do loops, but we had to extend our
implementation to support printing it. So, we now support printing and writing
of <code>tuple</code> in <code>ImpliedDoLoop</code>, e.g.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span><span style="color:#66d9ef">print</span> <span style="color:#f92672">*</span>, (i, A(i), i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
</span></span></code></pre></div><p>now works. The changes are detailed in this <a href="https://github.com/lfortran/lfortran/pull/4683">PR#4683</a>.</p>
<h3 id="string-format-enhancement">String format enhancement</h3>
<p>We had to provide runtime implementation of computing the formatting of the resulting print statement. The implementation required array handling in the runtime, which made us able to print arrays with the desired format. It is tracked via <a href="https://github.com/lfortran/lfortran/issues/4507">issue#4507</a>.</p>
<h3 id="overcoming-the-global-subroutine-linking-issue">Overcoming the global subroutine linking issue</h3>
<p>We encountered an issue related to the linking of global subroutines. It was challenging to determine whether this was due to an error in SNAP&rsquo;s code or a bug in LFortran. After extensive investigation, we identified it as a bug in LFortran, which was subsequently reported and tracked at <a href="https://github.com/lfortran/lfortran/issues/4435">issue #4435</a>. This issue underscores the need for improvements in LFortran&rsquo;s handling of global subroutines and their linkage, especially when they are not encapsulated within modules.</p>
<h3 id="overshadow-variables">Overshadow variables</h3>
<p>We encountered the case where we had to overshadow the variables in the order of their declaration, so we added this feature in the process of building the ASR, and we also raised a warning for the user to be aware of the behavior the compiler is following. The related issue is tracked <a href="https://github.com/lfortran/lfortran/pull/4191">here</a>.</p>
<h3 id="improve-interface-matching">Improve interface matching</h3>
<p>We encountered a case where matching function with interface didn&rsquo;t work properly due a missing edge case in the implementation of the matcher. With the help of how the nodes are structred, we were able to implement that with no problem. Detailed discussion over it is done at <a href="https://github.com/lfortran/lfortran/issues/4131">issue#4131</a>.</p>
<h2 id="whats-next">What&rsquo;s Next?</h2>
<p>As of this writing, LFortran compiles seven third-party codes:</p>
<ul>
<li><a href="https://github.com/scipy/scipy/tree/f797ac7721310c7bd98bae416be1bed9975b4203/scipy/optimize/minpack">Legacy Minpack</a> (part of SciPy) and several more SciPy packages</li>
<li><a href="https://github.com/fortran-lang/minpack">Modern Minpack</a></li>
<li><a href="https://github.com/certik/fastGPT">fastGPT</a></li>
<li><a href="https://github.com/certik/dftatom">dftatom</a></li>
<li><a href="https://github.com/scipy/scipy">SciPy</a> (60%)</li>
<li><a href="https://github.com/fortran-lang/stdlib">stdlib</a> (85%)</li>
<li><a href="https://github.com/lanl/SNAP">SNAP</a></li>
</ul>
<p><a href="https://github.com/lfortran/lfortran/issues/3806">Here</a> is our issue to track priorities to reach beta quality.</p>
<p>Our primary goal is to bring LFortran from alpha to beta and we think compiling 10 third-party codes is a key milestone toward achieving this. Our approach involves prioritizing features based on their importance, ensuring that LFortran supports all language features present in the selected codes. Progress towards beta will be measured by successfully compiling and running these codes without alterations. We will keep on announcing each one as LFortran is able to fully compile and run. The codes we are targeting on next are <a href="https://github.com/fortran-lang/fpm">Fortran Package Manager (fpm)</a>, <a href="https://github.com/Reference-LAPACK/lapack">LAPACK</a>, <a href="https://github.com/libprima/prima">PRIMA</a> and remaining parts of Fortran stdlib and SciPy. Once we reach the milestone of compiling 10 codes, we&rsquo;ll collaborate with the community to identify additional steps needed for beta. A beta-quality compiler, in our context, is defined as one that executes user code without errors, though it may still contain bugs.</p>
<p>Additionally, we are prioritizing support for newer LLVM versions to ensure LFortran remains compatible with the latest technologies, including LLVM 17, 18, and beyond.</p>
<h2 id="join-us">Join Us</h2>
<p>We welcome new contributors to join our journey. If you&rsquo;re interested, please reach out on <a href="https://lfortran.zulipchat.com/">Zulip</a>. Working on LFortran is both challenging and rewarding, offering ample opportunities for learning and growth.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We want to thank:</p>
<ul>
<li><a href="https://sovereigntechfund.de/en/">Sovereign Tech Fund (STF)</a></li>
<li><a href="https://numfocus.org/">NumFOCUS</a></li>
<li><a href="https://quantstack.net/">QuantStack</a></li>
<li><a href="https://summerofcode.withgoogle.com/">Google Summer of Code</a></li>
<li><a href="https://www.johndcook.com/blog/expert-hipaa-deidentification/">John D. Cook</a></li>
<li><a href="https://lanl.gov/">LANL</a></li>
<li><a href="https://gsitechnology.com/">GSI Technology</a></li>
<li>Our GitHub, OpenCollective and NumFOCUS sponsors</li>
<li>All our contributors (84 so far!)</li>
</ul>
<h2 id="discussions">Discussions</h2>
<ul>
<li>Fortran Discourse:</li>
<li>Twitter:</li>
</ul>


        
          <div class="blog-tags">
            
              <a href="https://lfortran.org//tags/fortran/">Fortran</a>&nbsp;
            
              <a href="https://lfortran.org//tags/announcement/">Announcement</a>&nbsp;
            
              <a href="https://lfortran.org//tags/fortran-lang/">Fortran-lang</a>&nbsp;
            
              <a href="https://lfortran.org//tags/snap/">SNAP</a>&nbsp;
            
              <a href="https://lfortran.org//tags/lanl/">LANL</a>&nbsp;
            
          </div>
        

        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://lfortran.org/blog/2024/07/lfortran-supports-openmp-pragmas-and-do-concurrent/" data-toggle="tooltip" data-placement="top" title="LFortran supports OpenMP pragmas and Do Concurrent">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2024
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://lfortran.org/">LFortran</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
           
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://lfortran.org/js/main.js"></script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://lfortran.org/js/load-photoswipe.js"></script>









  </body>
</html>

